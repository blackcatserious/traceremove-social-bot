"use strict";(()=>{var e={};e.id=7570,e.ids=[7570,3594],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},35298:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>A,originalPathname:()=>I,patchFetch:()=>T,requestAsyncStorage:()=>_,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>L,staticGenerationBailout:()=>S});var o={};r.r(o),r.d(o,{DELETE:()=>h,GET:()=>m,dynamic:()=>E,runtime:()=>d});var s=r(10884),n=r(16132),i=r(21040),a=r(95798),l=r(28977),c=r(35747);class u{constructor(){this.logs=[],this.maxLogs=1e3,this.logLevel=(0,c.ZO)()||"info";let e=(0,c.Bd)();this.logFormat=e?.monitoring.logFormat||"json"}shouldLog(e){let t={debug:0,info:1,warn:2,error:3};return t[e]>=t[this.logLevel]}createLogEntry(e,t,r,o,s){let n={timestamp:new Date().toISOString(),level:e,message:t,context:r,metadata:o};return s&&(n.error={name:s.name,message:s.message,stack:(0,c.yK)()?s.stack:void 0}),n}writeLog(e){if(this.logs.push(e),this.logs.length>this.maxLogs&&this.logs.shift(),"json"===this.logFormat)console.log(JSON.stringify(e));else{let t=e.context?`[${e.context}] `:"",r=e.metadata?` ${JSON.stringify(e.metadata)}`:"",o=e.error?` Error: ${e.error.message}`:"";console.log(`${e.timestamp} ${e.level.toUpperCase()} ${t}${e.message}${r}${o}`)}}debug(e,t,r){this.shouldLog("debug")&&this.writeLog(this.createLogEntry("debug",e,t,r))}info(e,t,r){this.shouldLog("info")&&this.writeLog(this.createLogEntry("info",e,t,r))}warn(e,t,r){this.shouldLog("warn")&&this.writeLog(this.createLogEntry("warn",e,t,r))}error(e,t,r,o){this.shouldLog("error")&&this.writeLog(this.createLogEntry("error",e,r,o,t))}getLogs(e,t){let r=e?this.logs.filter(t=>t.level===e):this.logs;return t&&(r=r.slice(-t)),r}clearLogs(){this.logs=[]}getLogStats(){let e={debug:0,info:0,warn:0,error:0};return this.logs.forEach(t=>{e[t.level]++}),{total:this.logs.length,byLevel:e,oldestTimestamp:this.logs[0]?.timestamp,newestTimestamp:this.logs[this.logs.length-1]?.timestamp}}}let g=new u,d="nodejs",E="force-dynamic";async function m(e){try{let{searchParams:t}=new URL(e.url),r=t.get("level"),o=t.get("limit")?parseInt(t.get("limit")):void 0,s="true"===t.get("stats");if(o&&(o<1||o>1e3))throw new l.p8("Limit must be between 1 and 1000");if(r&&!["debug","info","warn","error"].includes(r))throw new l.p8("Invalid log level. Must be one of: debug, info, warn, error");if(s){let e=g.getLogStats();return a.Z.json({stats:e,timestamp:new Date().toISOString()})}let n=g.getLogs(r||void 0,o);return a.Z.json({logs:n,total:n.length,level:r||"all",limit:o||"none",timestamp:new Date().toISOString()})}catch(r){let{response:e,status:t}=(0,l.$G)(r);return a.Z.json(e,{status:t})}}async function h(e){try{return g.clearLogs(),a.Z.json({success:!0,message:"Logs cleared successfully",timestamp:new Date().toISOString()})}catch(r){let{response:e,status:t}=(0,l.$G)(r);return a.Z.json(e,{status:t})}}let p=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/logs/route",pathname:"/api/admin/logs",filename:"route",bundlePath:"app/api/admin/logs/route"},resolvedPagePath:"/workspaces/traceremove-social-bot/src/app/api/admin/logs/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:_,staticGenerationAsyncStorage:L,serverHooks:f,headerHooks:A,staticGenerationBailout:S}=p,I="/api/admin/logs/route";function T(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:L})}},35747:(e,t,r)=>{r.d(t,{Bd:()=>s,ZO:()=>n,jQ:()=>a,yK:()=>i});class o extends Error{constructor(e,t){super(e),this.missingVars=t,this.name="EnvironmentValidationError"}}function s(){try{return function(){let e=[],t=[];function r(t){let r=process.env[t];return r||(e.push(t),"")}function s(e,r){let o=process.env[e];return o||void 0===r?o||void 0:(t.push(`${e} not set, using default: ${r}`),r)}function n(e,r){let o=process.env[e];if(!o)return void 0!==r?(t.push(`${e} not set, using default: ${r}`),r):void 0;let s=parseInt(o,10);return isNaN(s)?(t.push(`${e} is not a valid number, ignoring`),r):s}function i(e,r){let o=process.env[e];return o?"true"===o.toLowerCase():void 0!==r?(t.push(`${e} not set, using default: ${r}`),r):void 0}let a={openai:{apiKey:r("OPENAI_API_KEY")},multiModel:{anthropic:s("ANTHROPIC_API_KEY"),google:s("GOOGLE_API_KEY"),mistral:s("MISTRAL_API_KEY"),groq:s("GROQ_API_KEY")},notion:{token:r("NOTION_TOKEN"),databases:{registry:r("NOTION_DB_REGISTRY"),cases:r("NOTION_DB_CASES"),finance:r("NOTION_DB_FINANCE"),publishing:r("NOTION_DB_PUBLISHING")}},database:{pgDsn:r("PG_DSN"),poolMin:n("PG_POOL_MIN",2),poolMax:n("PG_POOL_MAX",20)},vector:{qdrantUrl:r("QDRANT_URL"),qdrantApiKey:r("QDRANT_API_KEY"),collectionName:s("QDRANT_COLLECTION_NAME","traceremove_vectors"),dimension:n("VECTOR_DIMENSION",1536)},cache:{redisUrl:s("UPSTASH_REDIS_REST_URL"),redisToken:s("UPSTASH_REDIS_REST_TOKEN"),ttlSearch:n("CACHE_TTL_SEARCH",3600),ttlDatabase:n("CACHE_TTL_DATABASE",1800),maxSize:n("CACHE_MAX_SIZE",1e3)},security:{cronSecret:r("CRON_SECRET"),rateLimitRequests:n("RATE_LIMIT_REQUESTS",100),rateLimitWindow:n("RATE_LIMIT_WINDOW",60)},monitoring:{logLevel:s("LOG_LEVEL","info"),logFormat:s("LOG_FORMAT","json"),enablePerformanceTracking:i("ENABLE_PERFORMANCE_TRACKING",!0),enableHealthChecks:i("ENABLE_HEALTH_CHECKS",!0)},etl:{fullSyncInterval:n("ETL_FULL_SYNC_INTERVAL",1440),incrementalSyncInterval:n("ETL_INCREMENTAL_SYNC_INTERVAL",60),batchSize:n("ETL_BATCH_SIZE",100),maxRetries:n("ETL_MAX_RETRIES",3)},development:{debugMode:i("DEBUG_MODE",!1),mockExternalApis:i("MOCK_EXTERNAL_APIS",!1),skipHealthChecks:i("SKIP_HEALTH_CHECKS",!1)}};if(t.length>0&&a.development.debugMode&&console.warn("Environment validation warnings:",t),e.length>0)throw new o(`Missing required environment variables: ${e.join(", ")}. Please check your .env.local file and ensure all required variables are set.`,e);return a}()}catch(e){if(e instanceof o)return console.error("Environment validation failed:",e.message),null;throw e}}function n(){return process.env.LOG_LEVEL||"info"}function i(){return"true"===process.env.DEBUG_MODE}function a(){return"true"===process.env.MOCK_EXTERNAL_APIS}},28977:(e,t,r)=>{r.d(t,{$G:()=>a,JN:()=>l,id:()=>n,p8:()=>s});class o extends Error{constructor(e,t=500,r,o){super(e),this.statusCode=t,this.code=r,this.details=o,this.name="APIError"}}class s extends o{constructor(e,t){super(e,400,"VALIDATION_ERROR",t),this.name="ValidationError"}}class n extends o{constructor(e,t,r){super(`${e} service error: ${t}`,502,"EXTERNAL_SERVICE_ERROR",r),this.name="ExternalServiceError"}}function i(e,t){let r={error:e.message,timestamp:new Date().toISOString()};return t&&(r.requestId=t),e instanceof o&&(r.code=e.code,r.details=e.details),r}function a(e){return(console.error("API Error:",e),e instanceof o)?{response:i(e),status:e.statusCode}:e instanceof Error?{response:i(e),status:500}:{response:{error:"An unexpected error occurred",timestamp:new Date().toISOString()},status:500}}async function l(e,t=3,r=1e3,o=2){let s;for(let n=1;n<=t;n++)try{return await e()}catch(i){if(s=i instanceof Error?i:Error(String(i)),n===t)throw s;let e=r*Math.pow(o,n-1);console.warn(`Attempt ${n} failed, retrying in ${e}ms:`,s.message),await new Promise(t=>setTimeout(t,e))}throw s}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[3271,8107],()=>r(35298));module.exports=o})();