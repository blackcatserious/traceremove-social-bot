"use strict";(()=>{var e={};e.id=4166,e.ids=[4166],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},87501:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>E,originalPathname:()=>I,patchFetch:()=>R,requestAsyncStorage:()=>D,routeModule:()=>v,serverHooks:()=>C,staticGenerationAsyncStorage:()=>S,staticGenerationBailout:()=>A});var o={};r.r(o),r.d(o,{GET:()=>p,POST:()=>m,dynamic:()=>l,runtime:()=>u});var n=r(10884),a=r(16132),s=r(21040),i=r(95798),c=r(28977);let u="nodejs",l="force-dynamic",d=new Map,f=[{id:"content-publishing",name:"Automated Content Publishing",description:"Generate and publish content across multiple platforms",steps:[{type:"trigger",name:"Schedule Trigger",config:{cron:"0 9 * * *"}},{type:"action",name:"Generate Content",config:{model:"gpt-4o",topic:"AI ethics"}},{type:"action",name:"Review Content",config:{threshold:.8}},{type:"action",name:"Publish to Social",config:{platforms:["twitter","linkedin"]}}]},{id:"data-sync",name:"Notion Database Sync",description:"Sync data between Notion databases and PostgreSQL",steps:[{type:"trigger",name:"Webhook Trigger",config:{source:"notion"}},{type:"action",name:"Extract Data",config:{database:"all"}},{type:"action",name:"Transform Data",config:{format:"postgresql"}},{type:"action",name:"Load to Database",config:{upsert:!0}}]},{id:"performance-monitoring",name:"System Performance Monitoring",description:"Monitor system performance and send alerts",steps:[{type:"trigger",name:"Interval Trigger",config:{interval:"5m"}},{type:"action",name:"Check Metrics",config:{endpoints:["all"]}},{type:"condition",name:"Performance Check",config:{threshold:2e3}},{type:"action",name:"Send Alert",config:{channels:["email","slack"]}}]}];async function p(e){try{let{searchParams:t}=new URL(e.url),r=t.get("action")||"list",o=t.get("id");switch(r){case"list":return i.Z.json({workflows:Array.from(d.values()),templates:f,stats:{total:d.size,active:Array.from(d.values()).filter(e=>"active"===e.status).length,totalRuns:Array.from(d.values()).reduce((e,t)=>e+t.runCount,0)}});case"get":if(!o)throw new c.p8("Workflow ID is required");let n=d.get(o);if(!n)return i.Z.json({error:"Workflow not found"},{status:404});return i.Z.json({workflow:n});case"templates":return i.Z.json({templates:f});case"run":if(!o)throw new c.p8("Workflow ID is required");let a=await w(o);return i.Z.json({result:a});default:return i.Z.json({error:"Invalid action"},{status:400})}}catch(r){console.error("Workflow automation API error:",r);let{response:e,status:t}=(0,c.$G)(r);return i.Z.json(e,{status:t})}}async function m(e){try{let{action:t,workflow:r,workflowId:o}=await e.json();switch(t){case"create":if(!r)throw new c.p8("Workflow data is required");let n=function(e){let t={id:`workflow_${Date.now()}`,name:e.name||"Untitled Workflow",description:e.description||"",status:"draft",trigger:e.trigger||{id:"trigger_1",type:"trigger",name:"Manual Trigger",config:{},nextSteps:[]},steps:e.steps||[],schedule:e.schedule,runCount:0,successRate:0};return d.set(t.id,t),t}(r);return i.Z.json({message:"Workflow created successfully",workflow:n});case"update":if(!o||!r)throw new c.p8("Workflow ID and data are required");let a=function(e,t){let r=d.get(e);if(!r)return null;let o={...r,...t};return d.set(e,o),o}(o,r);return i.Z.json({message:"Workflow updated successfully",workflow:a});case"delete":if(!o)throw new c.p8("Workflow ID is required");return d.delete(o),i.Z.json({message:"Workflow deleted successfully"});case"toggle":if(!o)throw new c.p8("Workflow ID is required");let s=function(e){let t=d.get(e);return t?(t.status="active"===t.status?"inactive":"active",d.set(e,t),t):null}(o);return i.Z.json({message:"Workflow status toggled",workflow:s});default:return i.Z.json({error:"Invalid action"},{status:400})}}catch(r){console.error("Workflow automation POST error:",r);let{response:e,status:t}=(0,c.$G)(r);return i.Z.json(e,{status:t})}}async function w(e){let t=d.get(e);if(!t)throw Error("Workflow not found");if("active"!==t.status)throw Error("Workflow is not active");let r=`exec_${Date.now()}`,o=Date.now();try{let n=[];for(let e of t.steps){let r=await g(e,t);if(n.push({stepId:e.id,stepName:e.name,success:r.success,output:r.output,duration:r.duration}),!r.success&&"condition"!==e.type)break}let a=n.every(e=>e.success),s=Date.now()-o;return t.runCount++,t.successRate=(t.successRate*(t.runCount-1)+(a?1:0))/t.runCount,t.lastRun=new Date,{executionId:r,workflowId:e,success:a,duration:s,steps:n,timestamp:new Date().toISOString()}}catch(e){throw t.runCount++,t.successRate=t.successRate*(t.runCount-1)/t.runCount,t.lastRun=new Date,e}}async function g(e,t){let r=Date.now();try{let o;switch(e.type){case"action":o=await h(e,t);break;case"condition":o=await y(e,t);break;case"delay":o=await k(e);break;default:o={success:!0,output:"Step executed"}}return{success:!0,output:o,duration:Date.now()-r}}catch(e){return{success:!1,output:e instanceof Error?e.message:"Unknown error",duration:Date.now()-r}}}async function h(e,t){switch(e.name){case"Generate Content":return{message:"Content generated successfully",contentId:`content_${Date.now()}`};case"Publish to Social":return{message:"Published to social media",platforms:e.config.platforms};case"Send Alert":return{message:"Alert sent",channels:e.config.channels};case"Extract Data":return{message:"Data extracted",records:Math.floor(100*Math.random())};default:return{message:`Action ${e.name} executed`}}}async function y(e,t){let r=e.config.threshold||0,o=3e3*Math.random(),n=o<r;return{condition:e.name,passed:n,currentValue:o,threshold:r,message:n?"Condition passed":"Condition failed"}}async function k(e){let t=e.config.delay||1e3;return await new Promise(e=>setTimeout(e,t)),{message:`Delayed for ${t}ms`}}let v=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/workflows/automation/route",pathname:"/api/workflows/automation",filename:"route",bundlePath:"app/api/workflows/automation/route"},resolvedPagePath:"/workspaces/traceremove-social-bot/src/app/api/workflows/automation/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:D,staticGenerationAsyncStorage:S,serverHooks:C,headerHooks:E,staticGenerationBailout:A}=v,I="/api/workflows/automation/route";function R(){return(0,s.patchFetch)({serverHooks:C,staticGenerationAsyncStorage:S})}},28977:(e,t,r)=>{r.d(t,{$G:()=>i,JN:()=>c,id:()=>a,p8:()=>n});class o extends Error{constructor(e,t=500,r,o){super(e),this.statusCode=t,this.code=r,this.details=o,this.name="APIError"}}class n extends o{constructor(e,t){super(e,400,"VALIDATION_ERROR",t),this.name="ValidationError"}}class a extends o{constructor(e,t,r){super(`${e} service error: ${t}`,502,"EXTERNAL_SERVICE_ERROR",r),this.name="ExternalServiceError"}}function s(e,t){let r={error:e.message,timestamp:new Date().toISOString()};return t&&(r.requestId=t),e instanceof o&&(r.code=e.code,r.details=e.details),r}function i(e){return(console.error("API Error:",e),e instanceof o)?{response:s(e),status:e.statusCode}:e instanceof Error?{response:s(e),status:500}:{response:{error:"An unexpected error occurred",timestamp:new Date().toISOString()},status:500}}async function c(e,t=3,r=1e3,o=2){let n;for(let a=1;a<=t;a++)try{return await e()}catch(s){if(n=s instanceof Error?s:Error(String(s)),a===t)throw n;let e=r*Math.pow(o,a-1);console.warn(`Attempt ${a} failed, retrying in ${e}ms:`,n.message),await new Promise(t=>setTimeout(t,e))}throw n}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[3271,8107],()=>r(87501));module.exports=o})();