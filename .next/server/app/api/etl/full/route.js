"use strict";(()=>{var e={};e.id=9860,e.ids=[9860,3594],e.modules={21841:e=>{e.exports=require("@aws-sdk/client-s3")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8678:e=>{e.exports=import("pg")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},5149:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{headerHooks:()=>_,originalPathname:()=>A,patchFetch:()=>l,requestAsyncStorage:()=>E,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>m});var o=t(10884),s=t(16132),i=t(21040),a=t(81263),u=e([a]);a=(u.then?(await u)():u)[0];let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/etl/full/route",pathname:"/api/etl/full",filename:"route",bundlePath:"app/api/etl/full/route"},resolvedPagePath:"/workspaces/traceremove-social-bot/src/app/api/etl/full/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:E,staticGenerationAsyncStorage:p,serverHooks:d,headerHooks:_,staticGenerationBailout:m}=c,A="/api/etl/full/route";function l(){return(0,i.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:p})}n()}catch(e){n(e)}})},81263:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{GET:()=>u,dynamic:()=>c,runtime:()=>l});var o=t(95798),s=t(12082),i=t(88307),a=e([s,i]);[s,i]=a.then?(await a)():a;let l="nodejs",c="force-dynamic";async function u(){try{console.log("Starting full ETL sync (nightly cron)..."),await (0,i.xN)();let e=await (0,s.fullSync)();return console.log("Full ETL sync completed:",e),o.Z.json({success:!0,type:"full",results:e,timestamp:new Date().toISOString()})}catch(e){return console.error("Full ETL sync failed:",e),o.Z.json({success:!1,error:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()},{status:500})}}n()}catch(e){n(e)}})},35747:(e,r,t)=>{t.d(r,{Bd:()=>o,ZO:()=>s,jQ:()=>a,yK:()=>i});class n extends Error{constructor(e,r){super(e),this.missingVars=r,this.name="EnvironmentValidationError"}}function o(){try{return function(){let e=[],r=[];function t(r){let t=process.env[r];return t||(e.push(r),"")}function o(e,t){let n=process.env[e];return n||void 0===t?n||void 0:(r.push(`${e} not set, using default: ${t}`),t)}function s(e,t){let n=process.env[e];if(!n)return void 0!==t?(r.push(`${e} not set, using default: ${t}`),t):void 0;let o=parseInt(n,10);return isNaN(o)?(r.push(`${e} is not a valid number, ignoring`),t):o}function i(e,t){let n=process.env[e];return n?"true"===n.toLowerCase():void 0!==t?(r.push(`${e} not set, using default: ${t}`),t):void 0}let a={openai:{apiKey:t("OPENAI_API_KEY")},multiModel:{anthropic:o("ANTHROPIC_API_KEY"),google:o("GOOGLE_API_KEY"),mistral:o("MISTRAL_API_KEY"),groq:o("GROQ_API_KEY")},notion:{token:t("NOTION_TOKEN"),databases:{registry:t("NOTION_DB_REGISTRY"),cases:t("NOTION_DB_CASES"),finance:t("NOTION_DB_FINANCE"),publishing:t("NOTION_DB_PUBLISHING")}},database:{pgDsn:t("PG_DSN"),poolMin:s("PG_POOL_MIN",2),poolMax:s("PG_POOL_MAX",20)},vector:{qdrantUrl:t("QDRANT_URL"),qdrantApiKey:t("QDRANT_API_KEY"),collectionName:o("QDRANT_COLLECTION_NAME","traceremove_vectors"),dimension:s("VECTOR_DIMENSION",1536)},cache:{redisUrl:o("UPSTASH_REDIS_REST_URL"),redisToken:o("UPSTASH_REDIS_REST_TOKEN"),ttlSearch:s("CACHE_TTL_SEARCH",3600),ttlDatabase:s("CACHE_TTL_DATABASE",1800),maxSize:s("CACHE_MAX_SIZE",1e3)},security:{cronSecret:t("CRON_SECRET"),rateLimitRequests:s("RATE_LIMIT_REQUESTS",100),rateLimitWindow:s("RATE_LIMIT_WINDOW",60)},monitoring:{logLevel:o("LOG_LEVEL","info"),logFormat:o("LOG_FORMAT","json"),enablePerformanceTracking:i("ENABLE_PERFORMANCE_TRACKING",!0),enableHealthChecks:i("ENABLE_HEALTH_CHECKS",!0)},etl:{fullSyncInterval:s("ETL_FULL_SYNC_INTERVAL",1440),incrementalSyncInterval:s("ETL_INCREMENTAL_SYNC_INTERVAL",60),batchSize:s("ETL_BATCH_SIZE",100),maxRetries:s("ETL_MAX_RETRIES",3)},development:{debugMode:i("DEBUG_MODE",!1),mockExternalApis:i("MOCK_EXTERNAL_APIS",!1),skipHealthChecks:i("SKIP_HEALTH_CHECKS",!1)}};if(r.length>0&&a.development.debugMode&&console.warn("Environment validation warnings:",r),e.length>0)throw new n(`Missing required environment variables: ${e.join(", ")}. Please check your .env.local file and ensure all required variables are set.`,e);return a}()}catch(e){if(e instanceof n)return console.error("Environment validation failed:",e.message),null;throw e}}function s(){return process.env.LOG_LEVEL||"info"}function i(){return"true"===process.env.DEBUG_MODE}function a(){return"true"===process.env.MOCK_EXTERNAL_APIS}},28977:(e,r,t)=>{t.d(r,{$G:()=>a,JN:()=>u,id:()=>s,p8:()=>o});class n extends Error{constructor(e,r=500,t,n){super(e),this.statusCode=r,this.code=t,this.details=n,this.name="APIError"}}class o extends n{constructor(e,r){super(e,400,"VALIDATION_ERROR",r),this.name="ValidationError"}}class s extends n{constructor(e,r,t){super(`${e} service error: ${r}`,502,"EXTERNAL_SERVICE_ERROR",t),this.name="ExternalServiceError"}}function i(e,r){let t={error:e.message,timestamp:new Date().toISOString()};return r&&(t.requestId=r),e instanceof n&&(t.code=e.code,t.details=e.details),t}function a(e){return(console.error("API Error:",e),e instanceof n)?{response:i(e),status:e.statusCode}:e instanceof Error?{response:i(e),status:500}:{response:{error:"An unexpected error occurred",timestamp:new Date().toISOString()},status:500}}async function u(e,r=3,t=1e3,n=2){let o;for(let s=1;s<=r;s++)try{return await e()}catch(i){if(o=i instanceof Error?i:Error(String(i)),s===r)throw o;let e=t*Math.pow(n,s-1);console.warn(`Attempt ${s} failed, retrying in ${e}ms:`,o.message),await new Promise(r=>setTimeout(r,e))}throw o}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[3271,8107,9809,8830,3326,2082],()=>t(5149));module.exports=n})();